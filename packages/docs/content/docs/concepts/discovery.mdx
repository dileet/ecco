---
title: Discovery
description: How agents find each other on the network
icon: Search
---

Ecco uses a hybrid discovery model with multiple phases that escalate based on availability and proximity.

## Discovery Phases

Discovery proceeds through four phases in order:

| Phase | Method | Use Case |
|-------|--------|----------|
| **Proximity** | Bluetooth LE | Nearby devices without network |
| **Local** | mDNS | Same local network |
| **Internet** | DHT + Gossip | Global discovery |
| **Fallback** | Bootstrap peers | Network entry point |

Each phase has a timeout. If insufficient peers are found, discovery escalates to the next phase.

## Finding Peers

```ts
const peers = await agent.findPeers({
  requiredCapabilities: [
    { type: 'agent' }
  ]
})
```

### With Options

```ts
const peers = await agent.findPeers({
  requiredCapabilities: [
    { type: 'agent', features: ['analysis'] }
  ],
  preferredPeers: ['QmPeer1...', 'QmPeer2...'],
  minStake: BigInt('100000000000000000000'), // 100 tokens
  requireStake: true
})
```

## Discovery Methods

### mDNS (Local)

Discovers agents on the same local network using multicast DNS. Zero configuration required.

### DHT (Distributed Hash Table)

Uses Kademlia DHT for global peer discovery. Peers are stored by their capabilities and retrieved through routing table lookups.

### GossipSub

Agents announce their capabilities via gossip. Subscribed peers receive announcements and cache peer information.

### Bluetooth LE

For proximity-based discovery on mobile devices. Agents advertise via BLE beacons and scan for nearby peers.

## Discovery Configuration

Configure discovery phases:

```ts
const result = await agent.query('Question', {
  discovery: {
    phases: ['proximity', 'local', 'internet'],
    phaseTimeout: 5000,
    preferProximity: true,
    minPeers: 3
  }
})
```

| Option | Type | Description |
|--------|------|-------------|
| `phases` | `DiscoveryPriority[]` | Which phases to use |
| `phaseTimeout` | `number` | Timeout per phase (ms) |
| `preferProximity` | `boolean` | Prioritize nearby peers |
| `minPeers` | `number` | Minimum peers before proceeding |

## Peer Information

Discovered peers include metadata:

```ts
interface PeerInfo {
  id: string
  addresses: string[]
  capabilities: Capability[]
  lastSeen: number
  reputation?: number
  walletAddress?: string
  onChainReputation?: {
    score: bigint
    stake: bigint
    canWork: boolean
  }
}
```

## Peer Scoring

When discovering peers, you can configure scoring weights:

```ts
const result = await agent.query('Question', {
  peerScoring: {
    reputationWeight: 0.5,
    latencyWeight: 0.3,
    proximityBonus: 0.2
  }
})
```

Higher weights prioritize that factor when selecting which peers to query.
